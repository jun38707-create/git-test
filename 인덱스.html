<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pulse Context Analyzer</title>
    <link rel="stylesheet" href="ìŠ¤íƒ€ì¼.css?v=1.1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+KR:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- Web App Manifest for PWA -->
    <link rel="manifest" href="ì„¤ì •.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div class="ambient-bg" id="ambient-overlay"></div>

    <header>
        <div class="pulse-container">
            <div class="pulse-wave"></div>
        </div>
        <div class="header-main">
            <h1 style="font-size: 1.2rem; font-weight: 700;">ë¹„ë°€ íŒŒíŠ¸ë„ˆ: ë§¥ë½ ë¶„ì„ê¸°</h1>
            <button id="settings-toggle" class="icon-btn">âš™ï¸</button>
        </div>

        <!-- API Key Settings (Hidden by default) -->
        <div id="settings-panel" class="settings-panel hidden">
            <h3 style="font-size: 0.9rem; margin-bottom: 0.5rem;">ğŸ”‘ AI ë°•ì‚¬ë‹˜ ì„¤ì • (v3.0)</h3>
            <p style="font-size: 0.75rem; color: #94a3b8; margin-bottom: 0.5rem;">í‚¤ê°€ ì—†ìœ¼ì‹ ê°€ìš”? <a
                    href="https://aistudio.google.com/app/apikey" target="_blank"
                    style="color: #6366f1; text-decoration: underline;">ì—¬ê¸°ì—ì„œ ë¬´ë£Œë¡œ ë°›ê¸°</a></p>
            <input type="password" id="api-key-input" placeholder="Google AI Studio API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                <button id="save-key-btn" class="save-btn" style="flex: 2;">ì €ì¥</button>
                <button onclick="checkAvailableModels(); event.stopPropagation();" class="save-btn"
                    style="flex: 1; background: #475569; font-size: 0.7rem;">ëª¨ë¸ ì ê²€</button>
                <button onclick="forceAppReload(); event.stopPropagation();" class="save-btn"
                    style="flex: 1; width: 100%; background: #1e293b; color: #94a3b8; font-size: 0.65rem; margin-top: 0.2rem;">ê°•ì œ
                    ì—…ë°ì´íŠ¸ ì¬ì„¤ì¹˜</button>
            </div>
        </div>
    </header>

    <main>
        <!-- Mood Card -->
        <div class="dashboard-card" id="mood-card">
            <div class="card-title">
                <span class="icon">ğŸŒ¡ï¸</span> ëŒ€í™” ì˜¨ë„
            </div>
            <div class="card-content" id="mood-status">ëŒ€í™” ëŒ€ê¸° ì¤‘...</div>
            <div class="tag-list" id="mood-tags">
                <!-- Tags will be injected here -->
            </div>
        </div>

        <!-- Intent Card -->
        <div class="dashboard-card" id="intent-card">
            <div class="card-title">
                <span class="icon">ğŸ”</span> ìˆ¨ì€ ì˜ë„
            </div>
            <div class="card-content" id="intent-status">ì…ë ¥ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.</div>
        </div>

        <!-- Next Step Card -->
        <div class="dashboard-card" id="action-card">
            <div class="card-title">
                <span class="icon">âš¡</span> ì¶”ì²œ ëŒ€ì‘
            </div>
            <div class="card-content" id="action-suggestion"
                style="font-size: 1rem; font-weight: 400; color: var(--text-dim);">
                ìƒëŒ€ë°©ì˜ ë§ì„ ë¶„ì„í•˜ë©´ ìµœì ì˜ ë‹µë³€ì„ ì œì•ˆí•©ë‹ˆë‹¤.
            </div>
        </div>

        <!-- Hidden Textarea for manual paste if voice fails -->
        <textarea id="text-input" placeholder="ì—¬ê¸°ì— ëŒ€í™” ë‚´ìš©ì„ ë¶™ì—¬ë„£ê±°ë‚˜ ì§ì ‘ ë§ì”€í•˜ì„¸ìš”..." rows="3"></textarea>
    </main>

    <div class="bottom-actions">
        <div class="status-bar" id="app-status">ê°ì§€ ì¤€ë¹„ ì™„ë£Œ</div>
        <div class="action-bar">
            <button id="analyze-btn" class="main-fab">
                <span class="btn-icon">ğŸ™ï¸</span>
                <span>ë¶„ì„ ì‹œì‘</span>
            </button>
        </div>
    </div>

    <!-- Post-Session Report Modal (v3.7 Total Cache Victory) -->
    <div id="report-overlay" class="report-overlay hidden" style="z-index: 9999; display: none;">
        <div class="report-modal">
            <div class="report-header" style="justify-content: space-between; display: flex; align-items: center;">
                <h3 style="display: flex; align-items: center; gap: 0.5rem; font-size: 1rem; margin: 0;">ğŸ“Š ëŒ€í™” ë¶„ì„ ë³´ê³ ì„œ
                    <span
                        style="font-size: 0.6rem; color: #111; background: #fbbf24; padding: 2px 5px; border-radius: 4px; margin-left: 5px; font-weight: bold;">v3.7
                        GOLD</span>
                </h3>
                <button onclick="window.closeReport()"
                    style="background:rgba(255,255,255,0.1); border:none; color:white; font-size:1.2rem; cursor:pointer; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; line-height: 1;">&times;</button>
            </div>
            <div id="report-body" class="report-body">
                <div style="text-align:center; padding: 2rem;">
                    <span class="pulse">ğŸ¤– ë¶„ì„ ë³´ê³ ì„œë¥¼ ì‘ì„± ì¤‘ì…ë‹ˆë‹¤...</span>
                </div>
            </div>
            <div class="report-footer">
                <button onclick="window.closeReport()" class="btn-secondary">ë‹«ê¸°</button>
                <button id="copy-report-btn" onclick="window.copyReport()" class="btn-primary">ë³´ê³ ì„œ ë³µì‚¬</button>
            </div>
            <div
                style="padding: 0.8rem; text-align: center; border-top: 1px solid rgba(255,255,255,0.05); display: flex; flex-direction: column; gap: 5px;">
                <button onclick="window.forceAppReload()"
                    style="background:none; border:none; color:#fbbf24; font-size:0.7rem; text-decoration:underline; cursor:pointer; font-weight:bold;">
                    ğŸ”¥ ë²„ì „ì´ ì•ˆ ë°”ë€Œë‚˜ìš”? [ê°•ì œ ìˆ˜ë™ ì—…ë°ì´íŠ¸]
                </button>
                <button onclick="window.panicReset()"
                    style="background:none; border:none; color:#ef4444; font-size:0.6rem; text-decoration:underline; cursor:pointer; opacity: 0.6;">
                    ğŸš¨ ì•±ì´ ì™„ì „íˆ ë¨¹í†µì¸ê°€ìš”? [ì „ì²´ ì´ˆê¸°í™” í—¬í”„]
                </button>
            </div>
        </div>
    </div>

    <!-- PWA Ultra Cache Destroyer (v3.7) -->
    <script>
        (function () {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(function (registrations) {
                    for (let registration of registrations) { registration.unregister(); }
                });
            }
            if ('caches' in window) {
                caches.keys().then(function (names) {
                    for (let name of names) caches.delete(name);
                });
            }
        })();
    </script>
    <script src="ì•±.js?v=20260110_v37_GOLD_PATCH"></script>
</body>

</html>